# 实验报告一
# 基于 VirtualBox 的网络攻防基础环境搭建

## 实验目的

* 掌握 VirtualBox 虚拟机的安装与使用；
* 掌握 VirtualBox 的虚拟网络类型和按需配置；
* 掌握 VirtualBox 的虚拟硬盘多重加载；

## 实验环境

以下是本次实验需要使用的网络节点说明和主要软件举例：

* VirtualBox 虚拟机
* 攻击者主机（Attacker）：Kali Rolling 2109.2
* 网关（Gateway, GW）：Debian Buster
* 靶机（Victim）：From Sqli to shell / xp-sp3 / Kali

## 实验要求

* 虚拟硬盘配置成多重加载，效果如下图所示；

![](https://c4pr1c3.github.io/cuc-ns/chap0x01/attach/chap0x01/media/vb-multi-attach.png)

* 搭建满足如下拓扑图所示的虚拟机网络拓扑；

![](https://c4pr1c3.github.io/cuc-ns/chap0x01/attach/chap0x01/media/vb-exp-layout.png)

> 根据实验宿主机的性能条件，可以适度精简靶机数量

* 完成以下网络连通性测试；
    - [x] 靶机可以直接访问攻击者主机
    - [x] 攻击者主机无法直接访问靶机
    - [x] 网关可以直接访问攻击者主机和靶机
    - [x] 靶机的所有对外上下行流量必须经过网关
    - [x] 所有节点均可以访问互联网

## 实验结果
- 安装虚拟机（虚拟硬盘配置成多重加载），并搭建满足实验要求的虚拟机网络拓扑。  
![](/img/VirtualBox.png)

|     主机名称      |                          IP地址                          |
| :---------------: | :------------------------------------------------------: |
|   Kali-Attacker   |                         10.0.2.5                         |
| Debian10-Gateway  | 10.0.2.15 & 192.168.56.113 & 172.16.111.1 & 172.16.222.1 |
|   Kali-victim-1   |                      172.16.111.109                      |
|    xp-victim-1    |                      172.16.111.112                      |
|    xp-victim-2    |                      172.16.222.119                      |
| Debian10-Victim-2 |                      172.16.222.145                      |

- 靶机直接访问攻击者主机
![](img/xp1-attacker.png)
![](/img/kali1-attacker.png)
![](img/debian2-attacker.png)
![](/img/xp2-attcaker.png)

- 攻击者主机无法直接访问靶机
![](/img/attacker-victim.png)

- 网关可以直接访问攻击者主机和靶机
![](img/gateway-all.png)

- 靶机的所有对外上下行流量必须经过网关
![](img/intnet2pcap.png)

- 所有节点均可以访问互联网
![](img/attacker-baidu.png)
![](img/gateway-baidu.png)
![](img/xp1-baidu.png)
![](img/kali1-baidu.png)
![](img/debian2-baidu.png)
![](img/xp2-baidu.png)

## 实验问题
- 攻击者主机Ping啥都通
![](img/pinganything.png)
经排查后发现为翻墙软件所致，关闭即可正常运行。
- ping不通xp  
关闭防火墙即可

## 参考资料
- [第一次上课前准备](https://c4pr1c3.github.io/cuc-wiki/ns/2021/calendar.html)
- [基于 VirtualBox 的网络攻防基础环境搭建](https://c4pr1c3.github.io/cuc-ns/chap0x01/exp.html#)
- [网络安全（2021）p12](https://www.bilibili.com/video/BV1CL41147vX?p=12)

---

## 课后思考
1. 以下⾏为分别破坏了CIA和AAA中哪⼀个属性或多个属性？

-  小明抄小强的作业  
CIA：机密性 AAA：认证、授权
-  小明把小强的系统折腾死机了  
CIA：可用性 AAA：授权
-  小明修改了小强的淘宝订单  
CIA：完整性、机密性 AAA：认证、授权
-  小明冒充小强的信用卡账单签名  
CIA：完整性 AAA：认证、授权
-  小明把自⼰电脑的IP修改为小强电脑的IP，导致小强的电脑⽆法上⽹  
CIA：可用性 AAA：认证、授权


2. 有⼀次，小明⼝袋里有100元，因为打瞌睡，被小偷偷⾛了，搞得晚上没饭吃。又⼀天，小明⼝袋里有200元，这次小明为了防范小偷，不打瞌睡了，但却被强盗持⼑威胁抢⾛了，搞得⼀天没饭吃，小明当天就报警了。

- 试分析两次失窃事件中的：风险、资产、威胁、弱点、攻击、影响
  |            |    风险    | 资产  |   威胁   |      弱点      |   攻击   |  影响  |
  | :--------: | :--------: | :---: | :------: | :------------: | :------: | :----: |
  | 第一次失窃 | 钱被偷走走 | 100元 |   小偷   |     人会困     |   偷窃   | 没饭吃 |
  | 第二次失窃 |  钱被抢走  | 200元 | 持刀强盗 | 人会遭受威胁 | 抢劫 | 没饭吃 |
- 试用P2DR模型分析以上案例中的“现⾦被抢”事件中的安全策略、安全防护、安全检测和安全响应

- “被抢”事件中，小明的安全策略存在何问题？


3. 针对下述论点，分别设计⼀场景案例（必须和课程相关），使得该论点在该场景中成立

- 预防比检测和恢复更重要
- 检测比预防和恢复更重要
- 恢复比预防和检测更重要


4. 试分析“CAPTCHA图片验证码技术可以阻⽌恶意批量注册⾏为”这句话中的安全策略、安全机制和安全假设分别是什么？CAPTCHA图片举例
- 安全策略：访问控制策略。
- 安全机制：设置具有一定难度验证码，只有验证码正确才能被授权进行注册。
- 安全假设：因为验证码具有一定难度，只有人才能对验证码进行高正确率的识别；计算机识别通过率低，从而达到防止批量注册的目的。


1. 某⼤型软件开发公司的总裁担⼼公司的专利软件设计⽅法被内部员⼯泄露给其他公司，他打算防⽌泄密事件的发⽣。于是他设计了这样⼀个安全机制：所有员⼯必须每天向他汇报自⼰和其他竞争对⼿公司员⼯的所有联系(包括IM、电⼦邮件、电话等等)。你认为该安全机制能达到总裁的预期安全效果吗？为什么？
- 不能达到总裁的预期安全效果
- 原因：